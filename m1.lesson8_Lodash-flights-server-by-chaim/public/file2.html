<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Demo File 2</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.5/lodash.min.js"></script>
</head>
<body>
<section>
    <h1>Demo File 2</h1>
    <button id="get">click to fetch flights JSON</button>
    <button id="sort">click to sort flights JSON</button>
</section>


<section>
    <table id="flight-table">
        <caption>flights</caption>
        <thead>
        <tr>
            <th>No.</th>
            <th>From</th>
            <th>To</th>
            <th>Departure</th>
            <th>Arrival</th>
            <th>By</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<script id='multi-entry-template1' type='text/x-handlebars-template'>
    {{#each entries}}
    <tr>
        <td>{{id}}</td>
        <td>{{from}}</td>
        <td>{{to}}</td>
        <td>{{departure}}</td>
        <td>{{arrival}}</td>
        <td>{{by}}</td>
    </tr>
    {{/each}}
</script>


<script>
    let data = '';
    const outputTable = document.querySelector('#flight-table tbody');
    const multiArticleTmpl1 = Handlebars.compile(document.getElementById('multi-entry-template1').innerHTML);

    document.querySelector('#get').onclick = function () {
        getFlights()
        renderTable(data, outputTable);
    };

    document.querySelector('#sort').onclick = function () {
        getFlights()
        renderTable(_.sortBy(data, ['id']), outputTable);
    };

    function renderTable(data, target) {
        target.innerHTML = multiArticleTmpl1({entries: data});
    }


    function getFlights() {
        fetch('flights.json')
            .then(function (resp) {
                return resp.json();
            })
            .then(function (json) {
                data = json;
            })
            .catch(function (err) {
                console.log('Error catch: - ', err);
            });
    }


</script>

</body>
</html>